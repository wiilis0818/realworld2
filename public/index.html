<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç”¨æˆ·ç™»å½•</title>
  <link rel="stylesheet" href="css/style.css">

  <script type="module">
    // Import Firebase SDKs
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js";

    // Firebase é…ç½®
    const firebaseConfig = {
      apiKey: "AIzaSyAjKBRRKgOmn1riONPsYEC0G9h-47EL9ug",
      authDomain: "willistest-40dff.firebaseapp.com",
      projectId: "willistest-40dff",
      storageBucket: "willistest-40dff.firebasestorage.app",
      messagingSenderId: "524383134160",
      appId: "1:524383134160:web:2fe912a3d5d2ad268c19d5",
      measurementId: "G-27HNC6CGVW"
    };

    // åˆå§‹åŒ– Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    console.log("ğŸ”¥ Firebase åˆå§‹åŒ–æˆåŠŸï¼", app);

    // åˆ›å»º Google ç™»å½•æä¾›è€…
    const provider = new GoogleAuthProvider();

    // Google ç™»å½•å‡½æ•°
    function loginWithGoogle() {
      signInWithPopup(auth, provider)
        .then((result) => {
          const user = result.user;
          console.log("âœ… Google ç™»å½•æˆåŠŸ", user);
          alert("âœ… Google ç™»å½•æˆåŠŸï¼š" + user.displayName);
          window.location.href = "mappage.html"; // ç™»å½•æˆåŠŸåè·³è½¬
        })
        .catch((error) => {
          console.error("âŒ Google ç™»å½•å¤±è´¥", error);
          alert("âŒ Google ç™»å½•å¤±è´¥ï¼š" + error.message);
        });
    }

    // ç»‘å®š Google ç™»å½•å‡½æ•°åˆ°å…¨å±€ä½œç”¨åŸŸ
    window.loginWithGoogle = loginWithGoogle;

    // é‚®ç®±ç™»å½•å‡½æ•°
    function loginUser() {
      let email = document.getElementById("email").value;
      let password = document.getElementById("password").value;
      let errorMessage = document.getElementById("errorMessage");

      signInWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
          const user = userCredential.user;
          console.log("âœ… ç™»å½•æˆåŠŸ", user);
          errorMessage.style.color = "green";
          errorMessage.textContent = "âœ… ç™»å½•æˆåŠŸï¼";
          window.location.href = "mappage.html"; // é‚®ç®±ç™»å½•æˆåŠŸåè·³è½¬
        })
        .catch((error) => {
          console.error("âŒ ç™»å½•å¤±è´¥", error.code, error.message);
          errorMessage.style.color = "red";
          errorMessage.textContent = "âŒ ç™»å½•å¤±è´¥ï¼š" + error.message;
        });
    }

    // ç»‘å®šé‚®ç®±ç™»å½•å‡½æ•°åˆ°å…¨å±€ä½œç”¨åŸŸ
    window.loginUser = loginUser;
  </script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #f4f4f4;
    }

    .container {
      background-color: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      width: 350px;
      text-align: center;
    }

    h2 {
      margin-bottom: 20px;
      font-size: 22px;
    }

    .btn {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }

    .btn-google {
      background-color: #ffffff;
      border: 1px solid #ccc;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn-google img {
      width: 20px;
      margin-right: 8px;
    }

    .divider {
      display: flex;
      align-items: center;
      margin: 20px 0;
      font-size: 14px;
      color: #999;
    }

    .divider::before,
    .divider::after {
      content: "";
      flex: 1;
      height: 1px;
      background-color: #ccc;
      margin: 0 10px;
    }

    .input-box {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
    }

    .btn-submit {
      background-color: black;
      color: white;
    }

    .login-link {
      font-size: 14px;
      margin-top: 10px;
    }

    .login-link a {
      color: black;
      text-decoration: none;
      font-weight: bold;
    }

    .login-link a:hover {
      text-decoration: underline;
    }
  </style>
</head>

<body>

<div class="container">
  <h2>ç”¨æˆ·ç™»å½•</h2>

  <button class="btn btn-google" onclick="loginWithGoogle()">
    <img src="https://www.svgrepo.com/show/303108/google-icon-logo.svg" alt="Google Logo"> ä½¿ç”¨ Google ç™»å½•
  </button>

  <div class="divider">æˆ–</div>

  <input type="email" class="input-box" id="email" placeholder="è¾“å…¥é‚®ç®±">
  <input type="password" class="input-box" id="password" placeholder="åˆ›å»ºå¯†ç ">

  <button class="btn btn-submit" onclick="loginUser()">é‚®ç®±ç™»å½•</button>

  <p class="login-link">å·²æœ‰è´¦æˆ·ï¼Ÿ <a href="#">ç™»å½•</a></p>
</div>

</body>
</html>
